# Enhanced rifle.conf for dark-terminal
# This configuration provides intelligent file opening for both desktop and headless systems

# =============================================================================
# TEXT FILES AND DOCUMENTS
# =============================================================================

# Markdown files - open in Neovim with markdown preview
mime ^text/markdown, has nvim, X, label markdown = nvim "$@"
mime ^text/markdown, has nvim, X!=, label markdown = nvim "$@"

# Code files - always open in Neovim
ext py|js|ts|jsx|tsx|html|css|scss|sass|less|json|xml|yaml|yml|toml|ini|cfg|conf|sh|bash|zsh|fish|lua|go|rs|cpp|c|h|hpp|java|kt|swift|php|rb|pl|sql, has nvim, label code = nvim "$@"

# Text files - open in Neovim
mime ^text, has nvim, label text = nvim "$@"

# Fallback for text files
mime ^text, has less, label view = less -- "$@"

# =============================================================================
# DOCUMENTS AND OFFICE FILES
# =============================================================================

# PDF files
ext pdf, has zathura, X, label pdf = zathura "$@"
ext pdf, has evince, X, label pdf = evince "$@"
ext pdf, has okular, X, label pdf = okular "$@"
ext pdf, has mupdf, label pdf = mupdf "$@"
ext pdf, has pdftotext, label pdf = pdftotext "$@" | less

# Word documents
ext doc|docx, has libreoffice, X, label word = libreoffice "$@"
ext doc|docx, has antiword, label word = antiword "$@" | less

# Spreadsheets
ext xlsx|xls|ods, has libreoffice, X, label spreadsheet = libreoffice "$@"
ext xlsx|xls|ods, has ssconvert, label spreadsheet = ssconvert --export-type=Gnumeric_stf:stf_csv "$@" "fd://1" | less

# Presentations
ext ppt|pptx|odp, has libreoffice, X, label presentation = libreoffice "$@"

# OpenDocument files
ext odt|rtf, has libreoffice, X, label document = libreoffice "$@"
ext odt|rtf, has pandoc, label document = pandoc -t plain "$@" | less

# =============================================================================
# IMAGES
# =============================================================================

# Image files - desktop
ext png|jpg|jpeg|gif|webp|bmp|tiff|svg, has feh, X, label image = feh "$@"
ext png|jpg|jpeg|gif|webp|bmp|tiff|svg, has sxiv, X, label image = sxiv "$@"
ext png|jpg|jpeg|gif|webp|bmp|tiff|svg, has nomacs, X, label image = nomacs "$@"
ext png|jpg|jpeg|gif|webp|bmp|tiff|svg, has gimp, X, label image = gimp "$@"

# Image files - headless (show info)
ext png|jpg|jpeg|gif|webp|bmp|tiff|svg, X!=, label image = file "$@" && echo "Size: $(du -h "$@" | cut -f1)"

# =============================================================================
# AUDIO AND VIDEO
# =============================================================================

# Video files
ext mp4|mkv|avi|mov|wmv|flv|webm|m4v, has mpv, label video = mpv "$@"
ext mp4|mkv|avi|mov|wmv|flv|webm|m4v, has vlc, X, label video = vlc "$@"
ext mp4|mkv|avi|mov|wmv|flv|webm|m4v, has ffplay, label video = ffplay "$@"

# Audio files
ext mp3|wav|flac|ogg|m4a|aac, has mpv, label audio = mpv "$@"
ext mp3|wav|flac|ogg|m4a|aac, has vlc, X, label audio = vlc "$@"
ext mp3|wav|flac|ogg|m4a|aac, has ffplay, label audio = ffplay "$@"

# =============================================================================
# ARCHIVES
# =============================================================================

# Archive files - extract or view contents
ext tar|tar.gz|tar.bz2|tar.xz|tgz|tbz2|txz, label archive = tar -tf "$@" | less
ext zip|jar|war|ear, label archive = unzip -l "$@" | less
ext rar, label archive = unrar l "$@" | less
ext 7z, label archive = 7z l "$@" | less

# =============================================================================
# DEVELOPMENT FILES
# =============================================================================

# Git repositories
ext git, has git, label git = git log --oneline | less

# Docker files
ext dockerfile, has nvim, label docker = nvim "$@"

# Configuration files
ext conf|config|ini|cfg, has nvim, label config = nvim "$@"

# =============================================================================
# WEB AND NETWORK
# =============================================================================

# URLs - open in browser
ext url|webloc, has firefox, X, label url = firefox "$@"
ext url|webloc, has chromium, X, label url = chromium "$@"
ext url|webloc, has google-chrome, X, label url = google-chrome "$@"

# HTML files
ext html|htm, has firefox, X, label html = firefox "$@"
ext html|htm, has chromium, X, label html = chromium "$@"
ext html|htm, has nvim, label html = nvim "$@"

# =============================================================================
# SYSTEM AND BINARY FILES
# =============================================================================

# Binary files - show info
ext exe|dll|so|dylib|bin|dat, label binary = file "$@" && echo "Size: $(du -h "$@" | cut -f1)"

# Script files - make executable and run
ext sh|bash|zsh|fish|py|pl|rb|php, has chmod, label script = chmod +x "$@" && "$@"

# =============================================================================
# DESKTOP INTEGRATION
# =============================================================================

# Desktop environment integration
has xdg-open, X, label desktop = xdg-open "$@"

# =============================================================================
# FALLBACKS
# =============================================================================

# Generic text files
mime ^text, label text = cat "$@"

# Unknown files - show file info
label unknown = file "$@" && echo "Size: $(du -h "$@" | cut -f1)"
